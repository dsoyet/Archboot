# Created by Tobias Powalowski <tpowa@archlinux.org>

install ()
{
    MODULES=""
    BINARIES="pacman"
    FILES=""
    SCRIPT="arch_pacman"

DEPENDS="initscripts cvs wget bash coreutils cryptsetup dialog \
e2fsprogs findutils gawk grep iputils jfsutils less lvm2 mdadm module-init-tools nano \
ncurses net-tools gnu-netcat ntfsprogs pcmciautils procps psmisc reiserfsprogs sed snarf \
syslog-ng sysvinit tar util-linux-ng which wireless_tools xfsprogs dnsutils hdparm memtest86+ \
grub netkit-telnet openssh hwdetect portmap shadow bridge-utils ifenslave cpufrequtils links tcp_wrappers \
dosfstools udev initscripts filesystem kernel26 glibc kernel-headers xinetd naim links pacman screen kbd pam \
dhcpcd bzip2 gcc-libs mktemp openssl zlib libelf gpm sysfsutils libgcrypt libgpg-error popt kexec-tools ppp libpcap \
rp-pppoe lilo grub iptables capi4k-utils ntfs-3g isdn4k-utils pciutils usbutils vpnc openvpn bcm43xx-fwcutter \
wpa_supplicant gzip rsync libarchive libdownload device-mapper cracklib nfs-utils nfsidmap readline acl attr \
pcre cpio archboot fuse klibc libusb vi lzo2 libsasl libldap libevent gpm sdparm pptpclient licenses \
madwifi madwifi-utils rt2x00-rt61-fw rt2x00-rt71w-fw rt2x00-cvs ndiswrapper ndiswrapper-utils \
zd1211-firmware wlan-ng26-utils wlan-ng26 ipw2100-fw ipw2200-fw iwlwifi iwlwifi-3945-ucode iwlwifi-4965-ucode smbclient"

for i in $DEPENDS; do
	for k in  $(echo /var/lib/pacman/local/$i-[0-9]*-[0-9]*); do
		add_file "$k/depends"
		add_file "$k/files"
		add_file "$k/desc"
	done
done
add_dir "/var/log"
add_file "/etc/archboot/etc/pacman/pacman.conf.pacman" "/etc/pacman.conf"
add_file "/etc/archboot/etc/pacman/core.pacman" "/etc/pacman.d/core"
add_file "/etc/archboot/etc/pacman/extra.pacman" "/etc/pacman.d/extra"
add_file "/etc/archboot/etc/pacman/unstable.pacman" "/etc/pacman.d/unstable"
add_file "/etc/archboot/etc/pacman/release.pacman" "/etc/pacman.d/release"
add_file "/etc/archboot/etc/pacman/community.pacman" "/etc/pacman.d/community"
}

help ()
{
cat<<HELPEOF
  This hook includes the pacman on an arch boot image.
HELPEOF
} 