# Created by Tobias Powalowski <tpowa@archlinux.org>

install ()
{
    MODULES=""
    BINARIES="pacman"
    FILES=""
    SCRIPT="arch_pacman_lowmem"

DEPENDS="initscripts bash coreutils cryptsetup dialog \
e2fsprogs findutils gawk grep jfsutils less lvm2 mdadm module-init-tools nano \
ncurses procps psmisc reiserfsprogs sed \
syslog-ng sysvinit tar util-linux-ng which xfsprogs hdparm memtest86+ \
grub hwdetect shadow dosfstools udev initscripts filesystem kernel26 glibc kernel-headers pacman pam \
bzip2 gcc-libs mktemp openssl zlib libelf gpm sysfsutils libgcrypt libgpg-error popt libpcap lilo grub gzip libarchive \
libdownload device-mapper cracklib readline acl attr archboot klibc libevent sdparm licenses"

for i in $DEPENDS; do
	for k in  $(echo /var/lib/pacman/local/$i-[0-9]*-[0-9]*); do
		add_file "$k/depends"
		add_file "$k/files"
		add_file "$k/desc"
	done
done
add_dir "/var/log"
add_file "/etc/archboot/etc/pacman/pacman.conf.pacman" "/etc/pacman.conf"
add_file "/etc/archboot/etc/pacman/core.pacman" "/etc/pacman.d/core"
add_file "/etc/archboot/etc/pacman/extra.pacman" "/etc/pacman.d/extra"
add_file "/etc/archboot/etc/pacman/unstable.pacman" "/etc/pacman.d/unstable"
add_file "/etc/archboot/etc/pacman/release.pacman" "/etc/pacman.d/release"
add_file "/etc/archboot/etc/pacman/community.pacman" "/etc/pacman.d/community"
}

help ()
{
cat<<HELPEOF
  This hook includes the pacman on a lowmem arch boot image.
HELPEOF
} 