#!/usr/bin/env bash
# Created by Tobias Powalowski <tpowa@archlinux.org>

build ()
{
    add_checked_modules -f 'nfp' -f 'liquidio' -f 'mellanox' -f 'wireless' -f 'bnx2x' -f 'bna' -f 'softing_cs' -f 'qed' '/drivers/net/'
    map add_binary route ip
    # start dhcpcd on startup
    add_symlink "/etc/systemd/system/multi-user.target.wants/iwd.service" "/usr/lib/systemd/system/iwd.service"
    add_symlink "/etc/systemd/system/multi-user.target.wants/systemd-networkd.service" "/usr/lib/systemd/system/systemd-networkd.service"
    add_symlink "/etc/systemd/system/multi-user.target.wants/systemd-resolved.service" "/usr/lib/systemd/system/systemd-resolved.service"
    add_file "/usr/share/archboot/net/etc/systemd/network/10-wired-auto-dhcp.network" "/etc/systemd/network/10-wired-auto-dhcp.network"
}

help ()
{
cat<<HELPEOF
  This hook includes the basic network on an archboot image.
HELPEOF
}
