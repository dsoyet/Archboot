#!/usr/bin/env bash
# Created by Tobias Powalowski <tpowa@archlinux.org>

build ()
{
    VIM_SHARE="$(echo /usr/share/vim/vim??)"
    add_binary "vim"
    add_file "/etc/vimrc"
    # fix vi symlink
    add_symlink "/usr/bin/vi" "/usr/bin/vim"
    add_file "/usr/share/vim/vimfiles/archlinux.vim"
    VIM_MODULE="syntax conf dosini sh grub manual synload colortest syncolor hitest whitespace nosyntax resolv fstab bash zsh exports passwd sysctl systemd vim"
    for i in ${VIM_MODULE}; do
        [[ -e "${VIM_SHARE}/syntax/$i.vim" ]] && add_file "${VIM_SHARE}/syntax/$i.vim"
        [[ -e "${VIM_SHARE}/indent/$i.vim" ]] && add_file "${VIM_SHARE}/indent/$i.vim"
    done
    VIM_BASIC_MODULE="defaults filetype indent indoff menu scripts synmenu"
    for i in ${VIM_BASIC_MODULE}; do
       [[ -e "${VIM_SHARE}/$i.vim" ]] && add_file "${VIM_SHARE}/$i.vim"
    done
    # fix colors
    [[ -e "${VIM_SHARE}/colors/lists/default.vim" ]] && add_file "${VIM_SHARE}/colors/lists/default.vim"
    add_file "/usr/share/licenses/vim/license.txt"
    add_full_dir "${VIM_SHARE}/autoload/dist"
}

help ()
{
cat<<HELPEOF
  This hook includes small version of vim on an archboot image.
HELPEOF
} 
